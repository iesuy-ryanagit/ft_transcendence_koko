# 概要

本Webアプリは、**アカウント認証付きPongゲーム**です。

# 技術要素

主な機能と技術要素は以下の通りです。

### 🎮 ゲーム機能
- ユーザー登録・ログインにより、Pongゲームをプレイ可能
- トーナメントアルゴリズムにより、トーナメントが自動作成
- ゲーム設定のカスタマイズが可能
- 画面表示の変更など、ユーザーによるカスタマイズに対応

### 🔑 認証・セキュリティ
- 42Tokyo APIによるリモート認証
- JWT認証を実装
- XSS攻撃、SQLインジェクションなどにも対応
- Google Authenticatorなどの多要素認証に対応

### ⚙️ その他の技術要素
- マイクロサービスで設計
- バックエンドはRESTful APIで設計
- トーナメントやゲームロジックはバックエンドサービスで設計
- ユーザーインターフェースはフロントエンドで柔軟にカスタマイズ可能


## アーキテクチャ概要

本システムは、**マイクロサービス設計**に基づき複数のコンテナで構成されています。  
各バックエンドサービスは独立しており、**RESTful APIサーバー**として機能します。

- **Nginx** をリバースプロキシとして利用  
  - 外部からのリクエストを各コンテナに適切にルーティング
  - HTTPS接続を提供し、安全な通信を実現

- バックエンドサービスは機能ごとに分離されており、  
  アカウント管理、ゲーム進行、トーナメント進行などを担当


![System Architecture](./docs/pictures/koko.svg)


## コンテナ構成



| コンテナ名              | 役割                                      | ポート番号 |
|--------------------|-----------------------------------------|---------|
| `account`          | アカウント管理を担当                          | 8000    |
| `backendgame`      | ゲーム（試合）の進行を担当                     | 8001    |
| `backendtournament`| トーナメントの進行を担当                     | 8002    |
| `db`               | データベース                               | 5432    |
| `frontend`         | フロントエンド（ユーザーインターフェース）       | 3000    |
| `nginx`            | リバースプロキシを担当（HTTPS対応）           | 4423     |

## アクセス方法

すべてのコンテナには直接アクセスせず、`nginx` を経由してHTTPS通信を行う。`nginx`はリバースプロキシとして機能し、特定のパスに基づいてリクエストを適切なコンテナにルーティングする。

### 各コンテナのURLパス

- **アカウント管理**（account コンテナ）  
  - URL: `/account/`
  - ポート: `8000`

- **ゲーム（試合）**（backendgame コンテナ）  
  - URL: `/pong/`
  - ポート: `8001`

- **トーナメント**（backendtournament コンテナ）  
  - URL: `/tournament/`
  - ポート: `8002`

- **フロントエンド**（frontend コンテナ）  
  - URL: `/html/`
  - ポート: `3000`

### リバースプロキシ設定

Nginxは以下のように各コンテナにリクエストを転送する。

- `/account/` → `account` コンテナ（ポート8000）
- `/game/` → `backendgame` コンテナ（ポート8001）
- `/tournament/` → `backendtournament` コンテナ（ポート8002）
- `/html/` → `frontend` コンテナ（ポート3000）

これにより、外部からはNginx（ポート4423）を通じてアクセスし、内部の各コンテナには適切にルーティングされます。
